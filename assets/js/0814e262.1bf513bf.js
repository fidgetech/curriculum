"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[87313],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var l=t(96540);const s={},i=l.createContext(s);function a(e){const n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(i.Provider,{value:n},e.children)}},82341:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"c-and-net/building-an-api/3-6-2-5-mvc-client-getdetails","title":"\ud83d\udcd3 3.6.2.5 MVC Client: GetDetails()","description":"In the last lesson, we created a GetAll() method that returns a list of all animals from our API. Now we\'re ready to add methods to our Animal and ApiHelper classes for retrieving a single animal\'s details. The methods we\'ll add will look quite similar to the ones we already have.","source":"@site/docs/3_c-and-net/6_building-an-api/3-6-2-05-mvc-client-getdetails.md","sourceDirName":"3_c-and-net/6_building-an-api","slug":"/c-and-net/building-an-api/3-6-2-5-mvc-client-getdetails","permalink":"/v1.2/c-and-net/building-an-api/3-6-2-5-mvc-client-getdetails","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\ud83d\udcd3 3.6.2.5 MVC Client: GetDetails()","day":"tuesday","id":"3-6-2-5-mvc-client-getdetails","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 3.6.2.4 MVC Client: GetAll()","permalink":"/v1.2/c-and-net/building-an-api/3-6-2-4-mvc-client-getall"},"next":{"title":"\ud83d\udcd3 3.6.2.6 MVC Client: POST, PUT, and DELETE","permalink":"/v1.2/c-and-net/building-an-api/3-6-2-6-mvc-client-post-put-and-delete"}}');var s=t(74848),i=t(28453);const a={title:"\ud83d\udcd3 3.6.2.5 MVC Client: GetDetails()",day:"tuesday",id:"3-6-2-5-mvc-client-getdetails",hide_table_of_contents:!0},r=void 0,d={},o=[{value:"GET for an Animal&#39;s Details",id:"get-for-an-animals-details",level:2},{value:"Adding Controller Action and View",id:"adding-controller-action-and-view",level:2}];function c(e){const n={a:"a",code:"code",div:"div",em:"em",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["In the last lesson, we created a ",(0,s.jsx)(n.code,{children:"GetAll()"})," method that returns a list of all animals from our API. Now we're ready to add methods to our ",(0,s.jsx)(n.code,{children:"Animal"})," and ",(0,s.jsx)(n.code,{children:"ApiHelper"})," classes for retrieving a single animal's details. The methods we'll add will look quite similar to the ones we already have."]}),"\n",(0,s.jsx)(n.h2,{id:"get-for-an-animals-details",children:"GET for an Animal's Details"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["Here's the new ",(0,s.jsx)(n.code,{children:"GetDetails()"})," method that we'll add to our ",(0,s.jsx)(n.code,{children:"Animal"})," class"]}),"\n",(0,s.jsx)(n.div,{className:"filename",children:"Models/Animal.cs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"...\nnamespace CretaceousClient.Models\n{\n  public class Animal\n  {\n    ...\n\n    public static Animal GetDetails(int id)\n    {\n      var apiCallTask = ApiHelper.Get(id);\n      var result = apiCallTask.Result;\n\n      JObject jsonResponse = JsonConvert.DeserializeObject<JObject>(result);\n      Animal animal = JsonConvert.DeserializeObject<Animal>(jsonResponse.ToString());\n\n      return animal;\n    }\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Why can't we just use one method for both the get all and get details functionality? Couldn't we just add an ",(0,s.jsx)(n.code,{children:"id"})," to the URL string? The redundant code that we are creating doesn't look very DRY."]}),"\n",(0,s.jsx)(n.p,{children:"Well, even though the core functionality of our methods is the same, they return different types of data and must be separated."}),"\n",(0,s.jsxs)(n.p,{children:["Here, we can see three key differences between our ",(0,s.jsx)(n.code,{children:"GetDetails()"})," and ",(0,s.jsx)(n.code,{children:"GetAnimals()"})," methods:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["We need to call on the ",(0,s.jsx)(n.code,{children:"ApiHelper.Get()"})," method, instead of the ",(0,s.jsx)(n.code,{children:"ApiHelper.GetAll()"})," method."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"GetDetails()"})," method returns a singular animal."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"GetDetails()"})," method takes in the ",(0,s.jsx)(n.code,{children:"id"})," of the animal."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The API call within ",(0,s.jsx)(n.code,{children:"GetDetails()"})," results in a JSON ",(0,s.jsx)(n.em,{children:"object"})," as opposed to a JSON ",(0,s.jsx)(n.em,{children:"array"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Because of all of these reasons, we still need to create a new method for getting a single animal's details even though the code looks nearly identical to getting all animals from the database."}),"\n",(0,s.jsxs)(n.p,{children:["Now let's add the ",(0,s.jsx)(n.code,{children:"ApiHelper.Get()"})," method:"]}),"\n",(0,s.jsx)(n.div,{className:"filename",children:"Models/ApiHelper.cs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'...\nnamespace CretaceousClient.Models\n{\n  public class ApiHelper\n  {\n    ...\n\n    public static async Task<string> Get(int id)\n    {\n      RestClient client = new RestClient("http://localhost:5000/");\n      RestRequest request = new RestRequest($"api/animals/{id}", Method.Get);\n      RestResponse response = await client.GetAsync(request);\n      return response.Content;\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"This should still look familiar as it reflects the code we use to make API calls to the New York Times quite closely."}),"\n",(0,s.jsxs)(n.p,{children:["As we discussed in the previous lesson, one key difference is using the ",(0,s.jsx)(n.code,{children:"GetAsync()"})," method, which will throw on a server error. To learn about the details of how error handling with RestSharp works, ",(0,s.jsx)(n.a,{href:"https://restsharp.dev/docs/advanced/error-handling",children:"visit the docs"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"adding-controller-action-and-view",children:"Adding Controller Action and View"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["Next, we'll add a controller action for ",(0,s.jsx)(n.code,{children:"Details()"}),":"]}),"\n",(0,s.jsx)(n.div,{className:"filename",children:"Controllers/AnimalsController.cs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"using Microsoft.AspNetCore.Mvc;\nusing CretaceousClient.Models;\n\nnamespace CretaceousClient.Controllers;\n\npublic class AnimalsController : Controller\n{\n  public IActionResult Index()\n  {\n    List<Animal> animals = Animal.GetAnimals();\n    return View(animals);\n  }\n\n  public IActionResult Details(int id)\n  {\n    Animal animal = Animal.GetDetails(id);\n    return View(animal);\n  }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Finally, we'll add a view:"}),"\n",(0,s.jsx)(n.div,{className:"filename",children:"Views/Animals/Details.cshtml"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'@{\n  ViewData["Title"] = $"Details for {Model.Name}";\n}\n\n<h1>All About @Model.Name</h1>\n\n<p>Species: @Model.Species</p>\n<p>Age: @Model.Age</p>\n\n@Html.ActionLink("Return to all animals", "Index")\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In the next lesson in this series, we'll cover new ground and make requests that ",(0,s.jsx)(n.em,{children:"send"})," data rather than ",(0,s.jsx)(n.em,{children:"receive"})," it."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);