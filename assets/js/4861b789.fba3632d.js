"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[9476],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var o=n(96540);const s={},i=o.createContext(s);function r(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:t},e.children)}},47295:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"react/react-with-apis/3-5-0-6-ny-times-api-implementing-usereducer","title":"\ud83d\udcd3 3.5.0.6 NY Times API: Implementing useReducer","description":"Now it\'s time to refactor the TopStories component to use the useReducer() hook. Let\'s first take a look at the updated code, and then review the changes in detail down below.","source":"@site/versioned_docs/version-WIP/3_react/5_react-with-apis/3-5-0-06-ny-times-api-implementing-usereducer.md","sourceDirName":"3_react/5_react-with-apis","slug":"/react/react-with-apis/3-5-0-6-ny-times-api-implementing-usereducer","permalink":"/WIP/react/react-with-apis/3-5-0-6-ny-times-api-implementing-usereducer","draft":false,"unlisted":false,"tags":[],"version":"WIP","frontMatter":{"title":"\ud83d\udcd3 3.5.0.6 NY Times API: Implementing useReducer","day":"weekend","id":"3-5-0-6-ny-times-api-implementing-usereducer","hide_table_of_contents":true},"sidebar":"react","previous":{"title":"\ud83d\udcd3 3.5.0.5 NY Times API: Writing and Testing our Reducer and Actions","permalink":"/WIP/react/react-with-apis/3-5-0-5-ny-times-api-writing-and-testing-our-reducer-and-actions"},"next":{"title":"\ud83d\udcd3 3.5.0.7 React Context","permalink":"/WIP/react/react-with-apis/3-5-0-7-react-context"}}');var s=n(74848),i=n(28453);const r={title:"\ud83d\udcd3 3.5.0.6 NY Times API: Implementing useReducer",day:"weekend",id:"3-5-0-6-ny-times-api-implementing-usereducer",hide_table_of_contents:!0},c=void 0,a={},d=[{value:"Next Steps",id:"next-steps",level:2}];function h(e){const t={a:"a",code:"code",div:"div",h2:"h2",hr:"hr",i:"i",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Now it's time to refactor the ",(0,s.jsx)(t.code,{children:"TopStories"})," component to use the ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook. Let's first take a look at the updated code, and then review the changes in detail down below."]}),"\n",(0,s.jsxs)(t.p,{children:["If you want to take on a challenge, try refactoring the ",(0,s.jsx)(t.code,{children:"TopStories"})," component to use the ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook by yourself before looking at the updated code below."]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TopStories.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"// We remove the useState hook and add the useReducer hook.\nimport React, { useEffect, useReducer } from 'react';\nimport topStoriesReducer from './../reducers/top-stories-reducer';\n// We import our action creators.\nimport { getTopStoriesFailure, getTopStoriesSuccess } from './../actions/index';\n\n// We create initial state for the useReducer hook.\nconst initialState = {\n  isLoaded: false,\n  topStories: [],\n  error: null\n};\n\nfunction TopStories () {\n  // We initialize the useReducer hook.\n  const [state, dispatch] = useReducer(topStoriesReducer, initialState);\n\n  useEffect(() => {\n    fetch(`https://api.nytimes.com/svc/topstories/v2/home.json?api-key=${process.env.REACT_APP_API_KEY}`)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(`${response.status}: ${response.statusText}`);\n        } else {\n          return response.json()\n        }\n      })\n      .then((jsonifiedResponse) => {\n        // We create an action and then dispatch it.\n        const action = getTopStoriesSuccess(jsonifiedResponse.results)\n        dispatch(action);\n      })\n      .catch((error) => {\n        // We create an action and then dispatch it. \n        const action = getTopStoriesFailure(error.message)\n        dispatch(action);\n      });\n    }, [])\n  \n  // we destructure error, isLoaded, and topStories from the state variable.\n  const { error, isLoaded, topStories } = state;\n\n  if (error) {\n    return <h1>Error: {error}</h1>;\n  } else if (!isLoaded) {\n    return <h1>...Loading...</h1>;\n  } else {\n    return (\n      <React.Fragment>\n        <h1>Top Stories</h1>\n        <ul>\n          {topStories.map((article, index) =>\n            <li key={index}>\n              <h3>{article.title}</h3>\n              <p>{article.abstract}</p>\n            </li>\n          )}\n        </ul>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default TopStories;\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Let's go over the changes we've made to ",(0,s.jsx)(t.code,{children:"TopStories.js"}),". Most of this should be familiar from what we've learned about the ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook in the ",(0,s.jsx)(t.code,{children:"Counter"})," example."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["First, we need to import ",(0,s.jsx)(t.code,{children:"useReducer"})," from React. We'll also need to remove the ",(0,s.jsx)(t.code,{children:"useState"})," import since we're no longer using it."]}),"\n",(0,s.jsxs)(t.li,{children:["Next, we need to import the two action creators that we'll use to generate our actions: ",(0,s.jsx)(t.code,{children:"getTopStoriesFailure"})," and ",(0,s.jsx)(t.code,{children:"getTopStoriesSuccess"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Next, outside of the ",(0,s.jsx)(t.code,{children:"TopStories"})," component, we create our initial state that will be added as an argument to the ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook. We could instead put the initial state in a separate file, or even in ",(0,s.jsx)(t.code,{children:"top-stories-reducer.js"}),", and import it into ",(0,s.jsx)(t.code,{children:"TopStories.js"}),". Whatever you do, you should be consistent across your entire application."]}),"\n",(0,s.jsxs)(t.li,{children:["We remove the three ",(0,s.jsx)(t.code,{children:"useState()"})," statements and replace them with a ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook, passing in the ",(0,s.jsx)(t.code,{children:"initialState"})," and ",(0,s.jsx)(t.code,{children:"topStoriesReducer"}),". We save the state and dispatch function that's returned from the ",(0,s.jsx)(t.code,{children:"useReducer()"})," hook in the variables ",(0,s.jsx)(t.code,{children:"state"})," and ",(0,s.jsx)(t.code,{children:"dispatch"}),"; remember that we can call these variables anything so long as it is descriptive of what it represents."]}),"\n",(0,s.jsxs)(t.li,{children:["Later in the ",(0,s.jsx)(t.code,{children:"useEffect()"})," hook and API call logic, when we receive a successful response or a failure response, we use either of our two action creator functions to generate an action, and then we dispatch that action using the ",(0,s.jsx)(t.code,{children:"dispatch()"})," function."]}),"\n",(0,s.jsxs)(t.li,{children:["Finally, the last step in this refactor is to destructure the ",(0,s.jsx)(t.code,{children:"error"}),", ",(0,s.jsx)(t.code,{children:"isLoaded"}),", and ",(0,s.jsx)(t.code,{children:"topStories"})," variables from the ",(0,s.jsx)(t.code,{children:"state"})," variable."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Now we can run our application and everything will be working correctly. In other words, our API application is complete! We now have the tools to make API calls with ",(0,s.jsx)(t.code,{children:"fetch()"})," in React applications with both the ",(0,s.jsx)(t.code,{children:"useState()"})," and ",(0,s.jsx)(t.code,{children:"useReducer()"})," hooks."]}),"\n",(0,s.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.p,{children:["As you build React apps, we encourage you to continue to use hooks to manage state and avoid class components. That includes whether you use hooks in conjunction with a state library like Redux, or standalone. If you would like to learn how to make an API call in a class component, ",(0,s.jsx)(t.a,{href:"https://reactjs.org/docs/faq-ajax.html",children:"visit the React docs."})]}),"\n",(0,s.jsxs)(t.p,{children:["Also, keep in mind that there are many, many custom React hooks out there. ",(0,s.jsx)(t.a,{href:"https://github.com/rehooks/awesome-react-hooks",children:"Check out this excellent list of resources on hooks"}),", which includes tutorials and links to various custom hooks. Among other things, these custom hooks offer the following additional functionality to function components:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Handling form state"}),"\n",(0,s.jsx)(t.li,{children:"Using the Fetch API"}),"\n",(0,s.jsx)(t.li,{children:"Drawing SVGs"}),"\n",(0,s.jsx)(t.li,{children:"Handling media queries"}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsxs)(t.a,{href:"https://github.com/epicodus-lessons/react-with-api-and-useReducer",children:[(0,s.jsx)(t.i,{className:"glyphicon glyphicon-folder-open"}),"  API Project with React and the ",(0,s.jsx)(t.code,{children:"useReducer()"})," Hook"]})})})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);