"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[79029],{28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>a});var o=n(96540);const s={},i=o.createContext(s);function c(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),o.createElement(i.Provider,{value:t},e.children)}},52179:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"react/react-with-redux/4-3-0-13-adding-redux-to-react-part-3","title":"\ud83d\udcd3 4.3.0.13 Adding Redux to React: Part 3","description":"In the last lesson, we updated the CRUD methods in our Help Queue application. They are now connected to a Redux store. In this lesson, we will use the mapStateToProps() function in order to display the state from our Redux store in our application. We will need to make minor changes in two components to do this.","source":"@site/docs/4_react/3_react-with-redux/4-3-0-13-adding-redux-to-react-part-3.md","sourceDirName":"4_react/3_react-with-redux","slug":"/react/react-with-redux/4-3-0-13-adding-redux-to-react-part-3","permalink":"/v1.2/react/react-with-redux/4-3-0-13-adding-redux-to-react-part-3","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\ud83d\udcd3 4.3.0.13 Adding Redux to React: Part 3","day":"weekend","id":"4-3-0-13-adding-redux-to-react-part-3","hide_table_of_contents":true},"sidebar":"react","previous":{"title":"\ud83d\udcd3 4.3.0.12 Adding Redux to React: Part 2","permalink":"/v1.2/react/react-with-redux/4-3-0-12-adding-redux-to-react-part-2"},"next":{"title":"\u270f\ufe0f 4.3.1.1 Redux Help Queue, Project Refactor","permalink":"/v1.2/react/react-with-redux/4-3-1-1-redux-help-queue-project-refactor"}}');var s=n(74848),i=n(28453);const c={title:"\ud83d\udcd3 4.3.0.13 Adding Redux to React: Part 3",day:"weekend",id:"4-3-0-13-adding-redux-to-react-part-3",hide_table_of_contents:!0},a=void 0,r={},d=[{value:"Mapping State to Props",id:"mapping-state-to-props",level:3},{value:"Adding PropTypes",id:"adding-proptypes",level:3},{value:"Updating Our Code To Use Our New Prop",id:"updating-our-code-to-use-our-new-prop",level:3}];function l(e){const t={code:"code",div:"div",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["In the last lesson, we updated the CRUD methods in our Help Queue application. They are now connected to a Redux store. In this lesson, we will use the ",(0,s.jsx)(t.code,{children:"mapStateToProps()"})," function in order to display the state from our Redux store in our application. We will need to make minor changes in two components to do this."]}),"\n",(0,s.jsx)(t.h3,{id:"mapping-state-to-props",children:"Mapping State to Props"}),"\n",(0,s.jsxs)(t.p,{children:["We're now ready to use an extremely powerful part of React Redux: the ",(0,s.jsx)(t.code,{children:"mapStateToProps"})," function. This function takes a state slice from the store and then maps it to a prop in the component."]}),"\n",(0,s.jsxs)(t.p,{children:["Add the following code just above the export statement at the end of ",(0,s.jsx)(t.code,{children:"TicketControl"}),". Note that we've already written the line with the ",(0,s.jsx)(t.code,{children:"connect()"})," function at the bottom of the code snippet below \u2014 however, a key addition has been made to that line of code."]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"...\n\nconst mapStateToProps = state => {\n  return {\n    mainTicketList: state\n  }\n}\n\n// Note: we are now passing mapStateToProps into the connect() function.\n\nTicketControl = connect(mapStateToProps)(TicketControl);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["In the code snippet above, we define how the ",(0,s.jsx)(t.code,{children:"mapStateToProps"})," function should look. It will always have the following format:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const mapStateToProps = state => {\n  return {\n    // Key-value pairs of state to be mapped from Redux to React component go here.\n  }\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The key-value pairs determine the state slices that should be mapped to the component's props. In our case, we want ",(0,s.jsx)(t.code,{children:"mainTicketList"})," from the store to be mapped to ",(0,s.jsx)(t.code,{children:"TicketControl"}),"'s props."]}),"\n",(0,s.jsxs)(t.p,{children:["Then we need to pass our newly-defined ",(0,s.jsx)(t.code,{children:"mapStateToProps"})," function into the ",(0,s.jsx)(t.code,{children:"connect()"})," function:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"TicketControl = connect(mapStateToProps)(TicketControl);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This ensures the ",(0,s.jsx)(t.code,{children:"TicketControl"})," component has the ",(0,s.jsx)(t.code,{children:"mapStateToProps"})," functionality when ",(0,s.jsx)(t.code,{children:"connect()"})," redefines the component."]}),"\n",(0,s.jsx)(t.h3,{id:"adding-proptypes",children:"Adding PropTypes"}),"\n",(0,s.jsxs)(t.p,{children:["We are mapping state from the Redux store to our component's props. That means we need to add prop types to ",(0,s.jsx)(t.code,{children:"TicketControl"}),". Let's do so now:"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'...\nimport PropTypes from "prop-types";\n\n...\n\nTicketControl.propTypes = {\n  mainTicketList: PropTypes.object\n};\n\n// mapStateToProps function is here.\n...\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"mainTicketList"})," in our Redux store is an object so we define it as that prop type."]}),"\n",(0,s.jsx)(t.h3,{id:"updating-our-code-to-use-our-new-prop",children:"Updating Our Code To Use Our New Prop"}),"\n",(0,s.jsxs)(t.p,{children:["Next, we need to pass this prop to where it's needed \u2014 our ",(0,s.jsx)(t.code,{children:"TicketList"})," component! We could also use the ",(0,s.jsx)(t.code,{children:"connect()"})," function directly in that component. However, we are already using ",(0,s.jsx)(t.code,{children:"connect()"})," in our ",(0,s.jsx)(t.code,{children:"TicketControl"})," component \u2014 and it will take a minimal refactor to get the ",(0,s.jsx)(t.code,{children:"TicketList"})," component working correctly."]}),"\n",(0,s.jsxs)(t.p,{children:["We will need to change two things in our ",(0,s.jsx)(t.code,{children:"TicketControl"})," component. First, we need to update our ",(0,s.jsx)(t.code,{children:"handleChangingSelectedTicket"})," method. Currently, the method looks like this:"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"...\nhandleChangingSelectedTicket = (id) => {\n  const selectedTicket = this.state.mainTicketList.filter(ticket => ticket.id === id)[0];\n  this.setState({selectedTicket: selectedTicket});\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"mainTicketList"})," is no longer part of ",(0,s.jsx)(t.code,{children:"this.state"})," \u2014 it's part of the Redux store now and we need to pass it into the component via ",(0,s.jsx)(t.code,{children:"this.props"}),". Also, ",(0,s.jsx)(t.code,{children:"mainTicketList"})," is an object now, not an array. No need to use filter anymore \u2014 we can just use bracket notation instead. Here's the updated method:"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"...\nhandleChangingSelectedTicket = (id) => {\n  const selectedTicket = this.props.mainTicketList[id];\n  this.setState({selectedTicket: selectedTicket});\n}\n...\n"})}),"\n",(0,s.jsxs)(t.p,{children:["We only need to change part of one line of code: we will now get the value of ",(0,s.jsx)(t.code,{children:"selectedTicket"})," from ",(0,s.jsx)(t.code,{children:"this.props.mainTicketList[id]"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["This is the power of ",(0,s.jsx)(t.code,{children:"mapStateToProps"}),": we don't have to do any fancy additional code to get a specific state slice from the store. We can just use ",(0,s.jsx)(t.code,{children:"this.props"})," \u2014 as long as we've defined the state slice we want to map in our ",(0,s.jsx)(t.code,{children:"mapStateToProps"})," function literal."]}),"\n",(0,s.jsxs)(t.p,{children:["There is one more line of code we need to change in ",(0,s.jsx)(t.code,{children:"TicketControl.js"}),". We need to change the ",(0,s.jsx)(t.code,{children:"ticketList"})," prop that is currently being passed down to the ",(0,s.jsx)(t.code,{children:"TicketList"})," component. Currently, it looks like this:"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"currentlyVisibleState = <TicketList ticketList={this.state.mainTicketList} onTicketSelection={this.handleChangingSelectedTicket} />;\n"})}),"\n",(0,s.jsx)(t.p,{children:"We'll extract the key piece of code that needs to be changed here for clarity's sake:"}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"<TicketList ticketList={this.state.mainTicketList}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Currently, our application is trying to pass down a prop called ",(0,s.jsx)(t.code,{children:"ticketList"})," that is set to ",(0,s.jsx)(t.code,{children:"this.state.mainTicketList"}),". Now we have to make a change that's similar to the one we just made \u2014 change the prop from ",(0,s.jsx)(t.code,{children:"this.state.mainTicketList"})," to ",(0,s.jsx)(t.code,{children:"this.props.mainTicketList"}),". Here's how the updated code should look:"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketControl.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"currentlyVisibleState = <TicketList ticketList={this.props.mainTicketList} onTicketSelection={this.handleChangingSelectedTicket} />;\n"})}),"\n",(0,s.jsxs)(t.p,{children:["As we see here, we just needed to change a single word. ",(0,s.jsx)(t.code,{children:"this.state"})," is changed to ",(0,s.jsx)(t.code,{children:"this.props"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Even though it's a small change in the code, there's a huge difference in what it means. At this point, you should have a clear understanding of the difference between ",(0,s.jsx)(t.code,{children:"this.state"})," (which refers to a class component's state) and ",(0,s.jsx)(t.code,{children:"this.props"})," (which refers to the props being passed into a component from a parent component or the Redux store)."]}),"\n",(0,s.jsxs)(t.p,{children:["We are almost done \u2014 everything would work correctly if we hadn't made another change to our application. Previously, all of our tickets were stored in an array. Now they are stored in an object. We will need to make a few small changes to the ",(0,s.jsx)(t.code,{children:"TicketList"})," component to get everything working as it should. There are three comments in the code below to point out the changes. (You should remove the comments from your own code.)"]}),"\n",(0,s.jsx)(t.div,{className:"filename",children:"src/components/TicketList.js"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"...\n\nfunction TicketList(props){\n  return (\n    <React.Fragment>\n      <hr />\n      {/* We now need to map over the values of an object, not an array. */}\n      {Object.values(props.ticketList).map((ticket) =>\n        <Ticket\n          whenTicketClicked = { props.onTicketSelection }\n          names={ticket.names}\n          location={ticket.location}\n          issue={ticket.issue}\n          id={ticket.id}\n          key={ticket.id}/>\n      )}\n      {/* Don't forget to add the curly brace above \u2014 otherwise there will be a syntax error. */}\n    </React.Fragment>\n  );\n}\n\n\nTicketList.propTypes = {\n  // The PropType below has been updated \u2014 it's now an object, not an array.\n  ticketList: PropTypes.object,\n  onTicketSelection: PropTypes.func\n};\n\n...\n"})}),"\n",(0,s.jsxs)(t.p,{children:["First, we iterate over the values of the ",(0,s.jsx)(t.code,{children:"ticketList"}),". We do this with the ",(0,s.jsx)(t.code,{children:"Object.values()"})," method, which grabs all the values from the object. Once we have the values, we can map over them."]}),"\n",(0,s.jsx)(t.p,{children:"At this point, everything should work correctly. We have successfully moved all of our shared state from our React application to a Redux store."}),"\n",(0,s.jsx)(t.p,{children:"Note that our application still has plenty of local state. As we've already mentioned, we're letting React handle that side of things. Once we add a Redux store to an application, it should always handle the application's shared state. However, local state can still be handled by React components. That being said, it's also perfectly okay to add local state to a Redux store as well. During class, you'll have the opportunity to refactor the Help Queue so that the Redux store handles all state \u2014 local and shared."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);