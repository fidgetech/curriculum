"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[15248],{4116:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"c-and-net/basic-web-applications/5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json","title":"\ud83d\udcd3 5.2.0.16 Debugging Views and Configuring a Development Environment with launchSettings.json","description":"Sometimes we have written a good program that compiles nicely. We build the project, run the server, and navigate to our app. At some point while navigating through our pages, we get an error and a page isn\'t returned. This generally results in a 500 server error message in the browser. (We\'ll cover server messages later.) Unfortunately, this vague message isn\'t helpful for debugging our code.","source":"@site/versioned_docs/version-WIP/c-and-net/2_basic-web-applications/3-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json.md","sourceDirName":"c-and-net/2_basic-web-applications","slug":"/c-and-net/basic-web-applications/5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json","draft":false,"unlisted":false,"tags":[],"version":"WIP","frontMatter":{"title":"\ud83d\udcd3 5.2.0.16 Debugging Views and Configuring a Development Environment with launchSettings.json","day":"weekend","id":"5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 5.2.0.15 Using Forms with MVC","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-15-using-forms-with-mvc"},"next":{"title":"\ud83d\udcd3 5.2.0.17 Redirecting to HTTPS and Issuing a Security Certificate","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate"}}');var i=o(74848),r=o(28453);const s={title:"\ud83d\udcd3 5.2.0.16 Debugging Views and Configuring a Development Environment with launchSettings.json",day:"weekend",id:"5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json",hide_table_of_contents:!0},a=void 0,l={},c=[{value:"Manually Configure <code>Program.cs</code>",id:"manually-configure-programcs",level:2},{value:"Run App in Development Mode",id:"run-app-in-development-mode",level:2},{value:"Configure a <code>launchSettings.json</code> File",id:"configure-a-launchsettingsjson-file",level:3},{value:"<code>launchSettings.json</code> and Starting a Server in Development Mode with a Watcher",id:"launchsettingsjson-and-starting-a-server-in-development-mode-with-a-watcher",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",div:"div",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Sometimes we have written a good program that compiles nicely. We build the project, run the server, and navigate to our app. At some point while navigating through our pages, we get an error and a page isn't returned. This generally results in a 500 server error message in the browser. (We'll cover server messages later.) Unfortunately, this vague message isn't helpful for debugging our code."}),"\n",(0,i.jsxs)(n.p,{children:["Well, we can configure our ASP.NET Core app to run a service called ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/error-handling?view=aspnetcore-6.0#developer-exception-page",children:"Developer Exception Page"})," that provides a more detailed error message when a webpage fails to load due to a server error. To get a sense of what these exception pages look like, check out the image below which shows an error in the Friend Letter project. On the left is the generic message from the browser, and on the right is the developer exception page that highlights the exact line of code that's throwing an error."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"A generic error message is pictured on the left and an error message via Developer Exception Pages is pictured on the right.",src:o(20729).A+"",width:"1314",height:"500"})}),"\n",(0,i.jsx)(n.p,{children:"As the image shows, having access to the detailed error messages in Developer Exception Pages is clearly an important tool for debugging."}),"\n",(0,i.jsxs)(n.p,{children:['Note that there are a few ways to enable Developer Exception Pages. We\'ll cover three in this lesson to get a sense of how ASP.NET Core apps can be configured. In the process, we\'ll learn how ASP.NET Core apps come with built-in configurations for different environments, like "development" or "production". However, we\'ll stick with one tool in the end, which is using a ',(0,i.jsx)(n.code,{children:"launchSettings.json"})," to run our apps in development mode, which automatically enables Developer Exception Pages."]}),"\n",(0,i.jsxs)(n.h2,{id:"manually-configure-programcs",children:["Manually Configure ",(0,i.jsx)(n.code,{children:"Program.cs"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["We can configure our ASP.NET Core app to use Developer Exception Pages by updating ",(0,i.jsx)(n.code,{children:"Program.cs"})," with a new line of code: ",(0,i.jsx)(n.code,{children:"app.UseDeveloperExceptionPage();"}),". To see exactly where to place this line of code, we'll use the ",(0,i.jsx)(n.code,{children:"Program.cs"})," from the Friend Letter application as an example:"]}),"\n",(0,i.jsx)(n.div,{className:"filename",children:"FriendLetter/Program.cs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cs",children:'using Microsoft.AspNetCore.Builder;\nusing Microsoft.Extensions.DependencyInjection;\n\nnamespace FriendLetter\n{\n  class Program\n  {\n    static void Main(string[] args)\n    {\n      WebApplicationBuilder builder = WebApplication.CreateBuilder(args);\n\n      builder.Services.AddControllersWithViews();\n\n      WebApplication app = builder.Build();\n\n      // new code!\n      app.UseDeveloperExceptionPage();\n\n      app.UseRouting();\n\n      app.MapControllerRoute(\n        name: "default",\n        pattern: "{controller=Home}/{action=Index}/{id?}"\n      );\n\n      app.Run();\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Notice that we place ",(0,i.jsx)(n.code,{children:"app.UseDeveloperExceptionPage();"})," right below the line of code that creates our ",(0,i.jsx)(n.code,{children:"WebApplication"})," host ",(0,i.jsx)(n.code,{children:"app"}),". You can do the same in any ASP.NET Core application."]}),"\n",(0,i.jsx)(n.p,{children:"The issue with this method is that we're enabling Developer Exception Pages all of the time, whether we're still developing our app or ready to deploy it in production. Well, we don't want Developer Exception Pages in production, because they take a fair amount of resources to run and can slow down our app. This means we only want to enable Developer Exception Pages during development, when we're actually writing and debugging code."}),"\n",(0,i.jsx)(n.p,{children:'Because code is optimized in different ways for production versus development, ASP.NET Core provides many tools to manage how our app should run in these two environments (and a third called "staging" that we won\'t get into).'}),"\n",(0,i.jsx)(n.p,{children:"As part of the version 6 release, all ASP.NET Core applications now come with a default configuration for Developer Exception Pages to automatically be enabled in development mode. That means all we need to do is learn how to start our projects in development mode. Let's do that next."}),"\n",(0,i.jsx)(n.h2,{id:"run-app-in-development-mode",children:"Run App in Development Mode"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["Without configuration, when we run our applications with ",(0,i.jsx)(n.code,{children:"dotnet run"})," or ",(0,i.jsx)(n.code,{children:"dotnet watch run"}),', they automatically are run in "production" mode, which includes the code, resources, and optimizations for our web apps to be hosted online and available for public use.']}),"\n",(0,i.jsxs)(n.p,{children:["To run our application in development mode, we simply need to add a flag to our ",(0,i.jsx)(n.code,{children:"dotnet run"})," command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dotnet run --environment Development\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When we do this, we'll see our environment confirmed in the terminal output. Notice ",(0,i.jsx)(n.code,{children:'"Hosting environment: Development"'})," in the output below."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ dotnet run --environment Development\ninfo: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[63]\n      User profile is available. Using 'C:\\Users\\staff\\AppData\\Local\\ASP.NET\\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.\ninfo: Microsoft.Hosting.Lifetime[14]\n      Now listening on: http://localhost:5000\ninfo: Microsoft.Hosting.Lifetime[14]\n      Now listening on: https://localhost:5001\ninfo: Microsoft.Hosting.Lifetime[0]\n      Application started. Press Ctrl+C to shut down.\ninfo: Microsoft.Hosting.Lifetime[0]\n      Hosting environment: Development\ninfo: Microsoft.Hosting.Lifetime[0]\n      Content root path: C:\\Users\\staff\\Desktop\\net6\\csharp-friend-letter-dotnet-5\\FriendLetter\\\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"configure-a-launchsettingsjson-file",children:["Configure a ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," File"]}),"\n",(0,i.jsxs)(n.p,{children:["However, there's an even better option for us than adding the command line flag ",(0,i.jsx)(n.code,{children:"--environment Development"})," to run our apps in development mode: we can create a file called ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," that contains information about what environment we want our project to be run. Let's start by creating this file and adding in the configurations."]}),"\n",(0,i.jsx)(n.p,{children:"Within the project's production directory, add the following:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["A new directory called ",(0,i.jsx)(n.code,{children:"Properties"})]}),"\n",(0,i.jsxs)(n.li,{children:["Within ",(0,i.jsx)(n.code,{children:"Properties"})," add a new file called ",(0,i.jsx)(n.code,{children:"launchSettings.json"})]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"launchsettingsjson-and-starting-a-server-in-development-mode-with-a-watcher",children:[(0,i.jsx)(n.code,{children:"launchSettings.json"})," and Starting a Server in Development Mode with a Watcher"]}),"\n",(0,i.jsx)(n.div,{className:"filename",children:"ProjectName.Solution/ProjectName/Properties/launchSettings.json"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "profiles": {\n    "development": {\n      "commandName": "Project",\n      "dotnetRunMessages": true,\n      "launchBrowser": true,\n      "applicationUrl": "https://localhost:5001;http://localhost:5000",\n      "environmentVariables": {\n        "ASPNETCORE_ENVIRONMENT": "Development"\n      }\n    },\n    "production": {\n      "commandName": "Project",\n      "dotnetRunMessages": true,\n      "launchBrowser": true,\n      "applicationUrl": "https://localhost:5001;http://localhost:5000",\n      "environmentVariables": {\n        "ASPNETCORE_ENVIRONMENT": "Production"\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Within ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," we've created two launch ",(0,i.jsx)(n.code,{children:'"profiles"'}),", that is, two different configurations with which we can launch our web app host."]}),"\n",(0,i.jsxs)(n.p,{children:["The first profile is called ",(0,i.jsx)(n.code,{children:'"development"'})," and the other is called ",(0,i.jsx)(n.code,{children:'"production"'}),". We can name our profiles whatever we like."]}),"\n",(0,i.jsxs)(n.p,{children:["Note that the first profile listed within the ",(0,i.jsx)(n.code,{children:'"profiles"'})," key becomes the default profile that is used when we run ",(0,i.jsx)(n.code,{children:"dotnet watch run"}),". Since the ",(0,i.jsx)(n.code,{children:'"development"'})," profile comes first, our site will be launched in development mode when we run our project with ",(0,i.jsx)(n.code,{children:"dotnet watch run"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To run the ",(0,i.jsx)(n.code,{children:'"production"'})," profile (or any other that is not the default), we'll need to specify it:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'dotnet watch run --launch-profile "production"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Notice that the configurations for both profiles are the same, except for the value of the environment variable: one is set to ",(0,i.jsx)(n.code,{children:'"Development"'})," and the other is set to ",(0,i.jsx)(n.code,{children:'"Production"'}),". When we run our app in development or production mode, we're primarily making use of the default configurations that ASP.NET Core sets for these two modes; like enabling Developer Exception Pages when our app is run in development mode."]}),"\n",(0,i.jsx)(n.p,{children:"Let's learn what each configuration does:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"commandName": "Project"'})," configures our project to use the Kestrel server. We could instead use a different server, but we do not have a reason to do that."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"dotnetRunMessages": true'})," configures our host to deliver us informative messages in the console about our project when it is run."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"launchBrowser": true'})," will not only run the web app host, but open our browser to the default application URL. The default for this setting is false, so if we want to have this feature turned on, we must do so via a ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," profile."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"applicationUrl": "https://localhost:5001;http://localhost:5000"'})," sets our application's port. We can change ",(0,i.jsx)(n.code,{children:"5001"})," and ",(0,i.jsx)(n.code,{children:"5000"})," to something else, though we may get conflicts. For example, if we change our port to ",(0,i.jsx)(n.code,{children:"3306"}),", the same port number that our MySQL server runs on, we'll get an error when we run our app: ",(0,i.jsx)(n.code,{children:"Unhandled exception. System.IO.IOException: Failed to bind to address https://localhost:3306."})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"environmentVariables"'})," sets the environment variables for our project. We only set one variable, which is a value for ",(0,i.jsx)(n.code,{children:'"ASPNETCORE_ENVIRONMENT"'}),' to set which mode or "environment" we want our app to be run in. In our case, ',(0,i.jsx)(n.code,{children:'"ASPNETCORE_ENVIRONMENT"'})," is set to either ",(0,i.jsx)(n.code,{children:'"Production"'})," or ",(0,i.jsx)(n.code,{children:'"Development"'}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Going forward, we'll use a ",(0,i.jsx)(n.code,{children:"Properties/launchSettings.json"})," file in all of our ASP.NET Core projects. Because of this, take note of a few important usage notes:"]})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The contents of the ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," file will be the same in all of our ASP.NET Core projects in LearnHowToProgram.com."]}),"\n",(0,i.jsxs)(n.li,{children:["You are welcome to configure the settings in ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," as you see fit, or just use the default configurations provided above."]}),"\n",(0,i.jsxs)(n.li,{children:["According to the MS Docs ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," is only used on the local development machine and should not be deployed. In other words, it's for development only."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["ASP.NET Core provides many tools to manage how our apps should run in different environments, like production and development. When we run our application in development mode, Developer Exception Pages are enabled by default such that we do not need to include ",(0,i.jsx)(n.code,{children:"app.UseDeveloperExceptionPage();"})," within ",(0,i.jsx)(n.code,{children:"Program.cs"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Intentionally running your app in development or production mode is standard practice, and better than enabling Developer Exception Pages as a default within ",(0,i.jsx)(n.code,{children:"Program.cs"}),". So, we recommend running your application in development mode by creating a ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," with a ",(0,i.jsx)(n.code,{children:'"development"'})," profile. We recommend using the ",(0,i.jsx)(n.code,{children:"launchSetting.json"})," file provided in this lesson, and we'll use it in all example ASP.NET Core projects. With a ",(0,i.jsx)(n.code,{children:"launchSettings.json"})," in place, we can run our application in development mode by running ",(0,i.jsx)(n.code,{children:"dotnet watch run"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To optionally learn more about about environments and configuring them through ",(0,i.jsx)(n.code,{children:"launchSettings.json"}),", visit the ",(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/environments?view=aspnetcore-6.0",children:"MS Docs on Using Multiple Environments in ASP.NET Core."})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},20729:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/error-messages-aspnetcore-e2741926cf223138e5608cae1387662f.png"},28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>a});var t=o(96540);const i={},r=t.createContext(i);function s(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);