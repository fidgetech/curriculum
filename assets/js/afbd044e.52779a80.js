"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[59573],{28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var s=n(96540);const o={},r=s.createContext(o);function i(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(r.Provider,{value:t},e.children)}},92603:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"react/react-with-redux/4-3-0-8-the-redux-store","title":"\ud83d\udcd3 4.3.0.8 The Redux Store","description":"Now we have a reducer that can handle some actions. Everything we\'ve done so far is vanilla JavaScript. We\'re ready to start working with Redux itself.","source":"@site/docs/4_react/3_react-with-redux/4-3-0-08-the-redux-store.md","sourceDirName":"4_react/3_react-with-redux","slug":"/react/react-with-redux/4-3-0-8-the-redux-store","permalink":"/v1.2/react/react-with-redux/4-3-0-8-the-redux-store","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\ud83d\udcd3 4.3.0.8 The Redux Store","day":"weekend","id":"4-3-0-8-the-redux-store","hide_table_of_contents":true},"sidebar":"react","previous":{"title":"\ud83d\udcd3 4.3.0.7 Anatomy of a Reducer","permalink":"/v1.2/react/react-with-redux/4-3-0-7-anatomy-of-a-reducer"},"next":{"title":"\ud83d\udcd3 4.3.0.9 Redux Store Review","permalink":"/v1.2/react/react-with-redux/4-3-0-9-redux-store-review"}}');var o=n(74848),r=n(28453);const i={title:"\ud83d\udcd3 4.3.0.8 The Redux Store",day:"weekend",id:"4-3-0-8-the-redux-store",hide_table_of_contents:!0},a=void 0,c={},l=[];function d(e){const t={a:"a",code:"code",div:"div",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"Now we have a reducer that can handle some actions. Everything we've done so far is vanilla JavaScript. We're ready to start working with Redux itself."}),"\n",(0,o.jsxs)(t.p,{children:["In this lesson, we will cover the Redux ",(0,o.jsx)(t.strong,{children:"store"}),". A Redux store does the following things:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Holds our application state;"}),"\n",(0,o.jsxs)(t.li,{children:["Allows us to access state in our application with the function ",(0,o.jsx)(t.code,{children:"getState()"}),";"]}),"\n",(0,o.jsxs)(t.li,{children:["Allows us to actually update state (with help from our reducers) using the ",(0,o.jsx)(t.code,{children:"dispatch()"})," function, which takes an action as an argument."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["That's all it does. It is a ",(0,o.jsx)(t.strong,{children:"single source of truth"})," that holds our application state. Because it is a single source of truth, there can only ever be one store in an application."]}),"\n",(0,o.jsxs)(t.p,{children:["In this lesson, we will use the reducer we built in previous lessons to create a small JavaScript project. The goal of this project is to demonstrate how Redux works. We are doing this independently of React because we need to use special bindings (provided by the ",(0,o.jsx)(t.code,{children:"react-redux"})," package) to use Redux with React. It isn't terribly difficult to set up a project with this package. However, it can be challenging for beginners to separate Redux code from the code needed to connect Redux to React. Our goal here is to keep Redux as simple as possible for now and focus on exploring how the Redux store works."]}),"\n",(0,o.jsxs)(t.p,{children:["To explore these concepts in isolation, we're going to create a new project (but don't worry, we'll come back to the other ticket-queue app we've been building soon!). Create a directory called ",(0,o.jsx)(t.code,{children:"learning-about-redux"})," and add the following file:"]}),"\n",(0,o.jsx)(t.div,{className:"filename",children:"index.html"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-html",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8">\n    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.5/redux.min.js"><\/script>\n    <script type="text/javascript" src="learning-about-redux.js"><\/script>\n    <title>Learning About Redux</title>\n  </head>\n  <body>\n  </body>\n</html>\n'})}),"\n",(0,o.jsxs)(t.p,{children:["This file has a link to a CDN for Redux as well as a link to the ",(0,o.jsx)(t.code,{children:"learning-about-redux.js"})," script we are about to create."]}),"\n",(0,o.jsxs)(t.p,{children:["As a quick refresher, ",(0,o.jsx)(t.strong,{children:"CDN"})," stands for ",(0,o.jsx)(t.strong,{children:"Content Delivery Network"}),", which is a way to tell the browser that is loading our project to fetch resources from a specific library we want to use in our project. We've used CDNs in the past with Bootstrap. Two alternatives to using a CDN are to simply download the files of a library and put them in your project folder, or to set up a package manager like ",(0,o.jsx)(t.code,{children:"npm"})," and load libraries to your project via a ",(0,o.jsx)(t.code,{children:"package.json"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["Next, add a file called ",(0,o.jsx)(t.code,{children:"learning-about-redux.js"})," to the project directory. We aren't going to worry about import statements, webpack, or anything else. Our file will just contain the reducer we built along with a few basic Redux methods and ",(0,o.jsx)(t.code,{children:"console.log()"})," statements to log what is happening."]}),"\n",(0,o.jsx)(t.p,{children:"Here's the code:"}),"\n",(0,o.jsx)(t.div,{className:"filename",children:"learning-about-redux.js"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"// REDUCER \u2014 this is the same code we wrote in our previous app.\n\nconst ticketListReducer = (state = {}, action) => {\n  const { names, location, issue, id } = action;\n  switch (action.type) {\n  case 'ADD_TICKET':\n    return Object.assign({}, state, {\n      [id]: {\n        names: names,\n        location: location,\n        issue: issue,\n        id: id\n      }\n    });\n  case 'DELETE_TICKET':\n    const newState = { ...state };\n    delete newState[id];\n    return newState;\n  default:\n    return state;\n  }\n};\n\n// REDUX STORE \u2014 Everything below this line is new code!\n\nconst { createStore } = Redux;\n\nconst store = createStore(ticketListReducer);\n\nconsole.log(store.getState());\n\nconst unsubscribe = store.subscribe(() => console.log(store.getState()));\n\nstore.dispatch({\n  type: 'ADD_TICKET',\n  names: 'Jasmine and Justine',\n  location: '2a',\n  issue: 'Reducer has side effects.',\n  id: 1\n});\n\nstore.dispatch({\n  type: 'ADD_TICKET',\n  names: 'Brann and Rose',\n  location: '3b',\n  issue: 'Problems understanding Redux.',\n  id: 2\n});\n\nstore.dispatch({\n  type: 'DELETE_TICKET',\n  id: 1\n});\n\nunsubscribe();\n"})}),"\n",(0,o.jsx)(t.p,{children:"We start with the reducer we've already created. We don't need to rehash this here, so let's skip right to the new code."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["We start by using destructuring to get the ",(0,o.jsx)(t.code,{children:"createStore"})," function from ",(0,o.jsx)(t.code,{children:"Redux"}),". (Remember that Redux is coming from the CDN.) We need this function to actually build our store."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Next, we create our store:"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"const store = createStore(ticketListReducer);\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"createStore()"})," takes a reducer as an argument. The reducer tells the store how it should handle actions. Otherwise, the store wouldn't know how to handle any actions."]}),"\n",(0,o.jsxs)(t.p,{children:["We save our created store in a constant called ",(0,o.jsx)(t.code,{children:"store"}),". This ",(0,o.jsx)(t.code,{children:"store"})," holds our application's state tree. The state tree is immutable \u2014 which means that the store will replace it with a new immutable structure each time it needs to be updated. Think of it as cleaning the old representation of state off a whiteboard and then drawing up a new representation."]}),"\n",(0,o.jsxs)(t.p,{children:["You may wonder why we are saving the store as a ",(0,o.jsx)(t.code,{children:"const"})," if the store itself can have changing representations of state. Well, ",(0,o.jsx)(t.code,{children:"const"})," is still a signal to other developers that they shouldn't modify the store at all. We'll let Redux handle that behind the scenes!"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Next, we can check the state of our store with ",(0,o.jsx)(t.code,{children:"getState()"}),". Note that ",(0,o.jsx)(t.code,{children:"getState()"})," is a method \u2014 we need to call it ",(0,o.jsx)(t.strong,{children:"on"})," our store."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Our learning application doesn't have a UI \u2014 we are just checking changes to state with ",(0,o.jsx)(t.code,{children:"console.log()"}),", so make sure to open the console when you run the project in the browser."]}),"\n",(0,o.jsx)(t.p,{children:"The following line logs our initial state in the console:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"console.log(store.getState());\n"})}),"\n",(0,o.jsx)(t.p,{children:"If we run our code in the browser, the console will show that the initial state is an empty object as expected. (This will be the first line that shows up in the console.)"}),"\n",(0,o.jsx)(t.p,{children:"However, this isn't very helpful for logging changes to the store's state."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["In order to actually log changes to state, we need to listen for changes with the ",(0,o.jsx)(t.code,{children:"subscribe()"})," method. You may remember that we ",(0,o.jsxs)(t.a,{href:"../../react/functional-programming-with-javascript/4-1-1-7-state",children:["briefly discussed the ",(0,o.jsx)(t.strong,{children:"pubsub"})," pattern"]})," when we learned about functional programming."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["A quick refresher: the pubsub pattern is a variant of the observer pattern. Various dependents (in an application) will listen for changes by ",(0,o.jsx)(t.strong,{children:"subscribing"})," to the store. Meanwhile, other objects will be ",(0,o.jsx)(t.strong,{children:"publishing"})," changes to the store. The publishers and subscribers don't need to know about each other \u2014 instead, the store acts as an intermediary."]}),"\n",(0,o.jsx)(t.p,{children:"We subscribe to our store with the following:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"const unsubscribe = store.subscribe(() => console.log(store.getState()));\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Let's take a closer look at this code. We are subscribing to the store with the ",(0,o.jsx)(t.code,{children:"subscribe()"})," method and storing that in a constant called ",(0,o.jsx)(t.code,{children:"unsubscribe"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["Note that we can call the code above ",(0,o.jsx)(t.strong,{children:"without"})," saving it in the ",(0,o.jsx)(t.code,{children:"unsubscribe"})," constant. However, then we won't be able to unsubscribe to it later."]}),"\n",(0,o.jsxs)(t.p,{children:["In our code, we are passing an anonymous function to ",(0,o.jsx)(t.code,{children:"store.subscribe()"}),". Each time there's a change in the store, our subscription will be triggered, causing this code to run:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"console.log(store.getState());\n"})}),"\n",(0,o.jsx)(t.p,{children:"When we subscribe, it just means our code is actively listening. For example, when we subscribe to a magazine, it doesn't mean we get an issue immediately. It just means that the next time an issue is published, we will get that issue."}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["We've subscribed \u2014 now what about getting the new issue of that magazine? Well, we need to ",(0,o.jsx)(t.strong,{children:"publish"})," it first. In this metaphor, the Redux store is our magazine. The store needs to be updated (a new issue of the magazine created) in order to trigger our subscription. In our Help Queue project, the store is holding our tickets. How do we update the store? We do this with the ",(0,o.jsx)(t.code,{children:"dispatch()"})," method. We dispatch three actions in the code below:"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"store.dispatch({\n  type: 'ADD_TICKET',\n  names: 'Jasmine and Justine',\n  location: '2a',\n  issue: 'Reducer has side effects.',\n  id: 1\n});\n\nstore.dispatch({\n  type: 'ADD_TICKET',\n  names: 'Brann and Rose',\n  location: '3b',\n  issue: 'Problems understanding Redux.',\n  id: 2\n});\n\nstore.dispatch({\n  type: 'DELETE_TICKET',\n  id: 1\n});\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Each time an action is dispatched, it will trigger our subscription and log the result of ",(0,o.jsx)(t.code,{children:"store.getState()"})," to the console."]}),"\n",(0,o.jsx)(t.p,{children:"If we run this application in the browser, we'll see four messages logged in the console. Our store changes as actions are dispatched to it!"}),"\n",(0,o.jsxs)(t.p,{children:["Finally, we can call ",(0,o.jsx)(t.code,{children:"unsubscribe()"})," to end our subscription. In the magazine metaphor, this means we've read enough issues of the magazine and we don't want more issues to come in the mail. For our Help Queue project, this means that we're no longer interested in tracking any store updates. When working with Redux, developers often use a dev tool like ",(0,o.jsx)(t.code,{children:"store.subscribe(() => console.log(store.getState()));"})," for debugging purposes."]}),"\n",(0,o.jsxs)(t.p,{children:["When we use bindings to combine Redux and React, we won't use the ",(0,o.jsx)(t.code,{children:"subscribe()"})," method ourselves. Instead, we'll use React Redux to handle subscribing for us. We'll do that because React Redux will optimize the subscription process for us \u2014 and make it easier in the process. However, even though we won't be using ",(0,o.jsx)(t.code,{children:"subscribe()"})," any longer, it's still important to know how it works."]}),"\n",(0,o.jsx)(t.p,{children:"In the next lesson, we'll review what we've learned so far about Redux. Even though the basics are relatively straightforward, it's very important to understand just what's happening in a Redux store."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);