"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[99945],{25219:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"c-and-net/database-basics/3-3-0-10-deleting-objects-in-the-database","title":"\ud83d\udcd3 3.3.0.10 Deleting Objects in the Database","description":"In the last lesson, we updated our teardown method for Item tests so that it utilizes our test database. However, our ClearAll() method doesn\'t have logic to clear Items from the database yet. In this lesson, we\'ll discuss how to write a method that deletes all table entries in a database. Once this is done, our teardown test method will be functional, allowing us to develop further database-driven functionality with the \\"Red, Green, Refactor\\" TDD workflow.","source":"@site/docs/3_c-and-net/3_database-basics/3-3-0-10-deleting-objects-in-the-database.md","sourceDirName":"3_c-and-net/3_database-basics","slug":"/c-and-net/database-basics/3-3-0-10-deleting-objects-in-the-database","permalink":"/v1.2/c-and-net/database-basics/3-3-0-10-deleting-objects-in-the-database","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\ud83d\udcd3 3.3.0.10 Deleting Objects in the Database","day":"weekend","id":"3-3-0-10-deleting-objects-in-the-database","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 3.3.0.09 Using the Test Database","permalink":"/v1.2/c-and-net/database-basics/3-3-0-09-using-the-test-database"},"next":{"title":"\ud83d\udcd3 3.3.0.11 Testing for an Empty Database","permalink":"/v1.2/c-and-net/database-basics/3-3-0-11-testing-for-an-empty-database"}}');var o=t(74848),s=t(28453);const d={title:"\ud83d\udcd3 3.3.0.10 Deleting Objects in the Database",day:"weekend",id:"3-3-0-10-deleting-objects-in-the-database",hide_table_of_contents:!0},i=void 0,c={},l=[{value:"Deleting All Objects from the Database",id:"deleting-all-objects-from-the-database",level:2}];function r(e){const n={code:"code",div:"div",h2:"h2",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["In the last lesson, we updated our teardown method for ",(0,o.jsx)(n.code,{children:"Item"})," tests so that it utilizes our test database. However, our ",(0,o.jsx)(n.code,{children:"ClearAll()"})," method doesn't have logic to clear ",(0,o.jsx)(n.code,{children:"Item"}),'s from the database yet. In this lesson, we\'ll discuss how to write a method that deletes all table entries in a database. Once this is done, our teardown test method will be functional, allowing us to develop further database-driven functionality with the "Red, Green, Refactor" TDD workflow.']}),"\n",(0,o.jsx)(n.h2,{id:"deleting-all-objects-from-the-database",children:"Deleting All Objects from the Database"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["Let's update our existing ",(0,o.jsx)(n.code,{children:"ClearAll()"})," method to interact with our database. If you've followed lessons exactly, ",(0,o.jsx)(n.code,{children:"ClearAll()"})," should currently be empty. Let's add code to create and open a new database connection."]}),"\n",(0,o.jsx)(n.div,{className:"filename",children:"ToDoList/Models/Item.cs"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"...\n\n   public static void ClearAll()\n   {\n     MySqlConnection conn = new MySqlConnection(DBConfiguration.ConnectionString);\n     conn.Open();\n   }\n\n...\n"})}),"\n",(0,o.jsxs)(n.p,{children:["We call ",(0,o.jsx)(n.code,{children:"new MySqlConnection(DBConfiguration.ConnectionString);"})," to create our ",(0,o.jsx)(n.code,{children:"conn"})," object and then call ",(0,o.jsx)(n.code,{children:"Open()"})," on it to open the connection. Remember that ",(0,o.jsx)(n.code,{children:"DBConfiguration.ConnectionString"})," is originally defined in ",(0,o.jsx)(n.code,{children:"DatabaseConfig.cs"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Next, we'll create a new ",(0,o.jsx)(n.code,{children:"MySqlCommand"})," object. It will include a SQL command to delete all rows from our ",(0,o.jsx)(n.code,{children:"items"})," database table:"]}),"\n",(0,o.jsx)(n.div,{className:"filename",children:"ToDoList/Models/Item.cs"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'...\n\n  public static void ClearAll()\n  {\n      MySqlConnection conn = new MySqlConnection(DBConfiguration.ConnectionString);\n      conn.Open();\n\n      MySqlCommand cmd = conn.CreateCommand() as MySqlCommand;\n      cmd.CommandText = "DELETE FROM items;";\n  }\n\n...\n'})}),"\n",(0,o.jsxs)(n.p,{children:["We define the ",(0,o.jsx)(n.code,{children:"CommandText"})," property of ",(0,o.jsx)(n.code,{children:"cmd"})," as the SQL statement ",(0,o.jsx)(n.code,{children:'"DELETE FROM items;"'}),", which will clear the entire ",(0,o.jsx)(n.code,{children:"items"})," table in our database."]}),"\n",(0,o.jsxs)(n.p,{children:["In ",(0,o.jsx)(n.code,{children:"GetAll()"})," we used a reader object to launch our SQL query and return data. However, we don't need to read anything when we delete something. In fact, we don't need anything returned to us at all. We just want the specified information removed from the database."]}),"\n",(0,o.jsx)(n.p,{children:"We'll execute this command using a new method from the MySqlConnector library:"}),"\n",(0,o.jsx)(n.div,{className:"filename",children:"ToDoList/Models/Item.cs"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'...\n\n   public static void ClearAll()\n   {\n     MySqlConnection conn = new MySqlConnection(DBConfiguration.ConnectionString);\n     conn.Open();\n\n     MySqlCommand cmd = conn.CreateCommand() as MySqlCommand;\n     cmd.CommandText = "DELETE FROM items;";\n     cmd.ExecuteNonQuery();\n  }\n\n...\n'})}),"\n",(0,o.jsxs)(n.p,{children:["SQL statements that modify data instead of querying and returning data are executed with the ",(0,o.jsx)(n.code,{children:"ExecuteNonQuery()"})," method, as seen here. Ultimately, there are two ways we interact with databases: we can either modify or retrieve data."]}),"\n",(0,o.jsx)(n.p,{children:"Modifying data can include adding, deleting, or updating entries. On the other hand, retrieving data includes locating and returning entries. When we save data, we're not searching for specific data. Instead, we're modifying the database by adding a new entry."}),"\n",(0,o.jsxs)(n.p,{children:["When we execute commands that modify the database, we use the ",(0,o.jsx)(n.code,{children:"ExecuteNonQuery()"})," method.  Commands that retrieve data use different methods like ",(0,o.jsx)(n.code,{children:"ExecuteReader()"}),", which we used in our ",(0,o.jsx)(n.code,{children:"GetAll()"})," method."]}),"\n",(0,o.jsx)(n.p,{children:"Now we just need to close our database connection when we're done:"}),"\n",(0,o.jsx)(n.div,{className:"filename",children:"ToDoList/Models/Item.cs"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'...\n\n   public static void ClearAll()\n   {\n     MySqlConnection conn = new MySqlConnection(DBConfiguration.ConnectionString);\n     conn.Open();\n\n     MySqlCommand cmd = conn.CreateCommand() as MySqlCommand;\n     cmd.CommandText = "DELETE FROM items;";\n     cmd.ExecuteNonQuery();\n\n     conn.Close();\n     if (conn != null)\n     {\n      conn.Dispose();\n     }\n  }\n\n...\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Here we simply call ",(0,o.jsx)(n.code,{children:"Close()"})," to close the connection. Our conditional confirms it's been successfully closed and destroys it if it's not."]}),"\n",(0,o.jsxs)(n.p,{children:["Now that we've created a ",(0,o.jsx)(n.code,{children:"ClearAll()"})," method to empty our test database between tests, we're ready to write tests for our database-backed methods."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>i});var a=t(96540);const o={},s=a.createContext(o);function d(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);