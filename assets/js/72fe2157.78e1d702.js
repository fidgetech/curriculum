"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[87424],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var o=n(96540);const a={},i=o.createContext(a);function s(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:t},e.children)}},56841:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"c-and-net/many-to-many-relationships/3-4-2-1-creating-a-splash-page-with-data-from-multiple-database-tables","title":"\ud83d\udcd3 3.4.2.1 Creating a Splash Page with Data from Multiple Database Tables","description":"In this lesson we\'re going to learn how to create a splash page that lists all of the objects saved in multiple database tables. A splash page is the first page that a user sees when they visit your site. They might contain promotions, offers, a beautiful image, or just be the homepage of your site.","source":"@site/versioned_docs/version-v1_3/3_c-and-net/4_many-to-many-relationships/3-4-2-01-creating-a-splash-page-with-data-from-multiple-database-tables.md","sourceDirName":"3_c-and-net/4_many-to-many-relationships","slug":"/c-and-net/many-to-many-relationships/3-4-2-1-creating-a-splash-page-with-data-from-multiple-database-tables","permalink":"/v1.3/c-and-net/many-to-many-relationships/3-4-2-1-creating-a-splash-page-with-data-from-multiple-database-tables","draft":false,"unlisted":false,"tags":[],"version":"v1_3","frontMatter":{"title":"\ud83d\udcd3 3.4.2.1 Creating a Splash Page with Data from Multiple Database Tables","day":"tuesday","id":"3-4-2-1-creating-a-splash-page-with-data-from-multiple-database-tables","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 Customizing Entity Properties with Data Annotations","permalink":"/v1.3/c-and-net/many-to-many-relationships/customizing-entity-properties-with-data-annotations"},"next":{"title":"\u270f\ufe0f 3.4.3.1 Refactoring with Many-To-Many","permalink":"/v1.3/c-and-net/many-to-many-relationships/3-4-3-1-refactoring-with-many-to-many"}}');var a=n(74848),i=n(28453);const s={title:"\ud83d\udcd3 3.4.2.1 Creating a Splash Page with Data from Multiple Database Tables",day:"tuesday",id:"3-4-2-1-creating-a-splash-page-with-data-from-multiple-database-tables",hide_table_of_contents:!0},r=void 0,l={},c=[{value:"Updating the <code>HomeController</code>",id:"updating-the-homecontroller",level:2},{value:"Updating the <code>Home/Index.cshtml</code> View",id:"updating-the-homeindexcshtml-view",level:2},{value:"Repository Reference",id:"repository-reference",level:3}];function d(e){const t={a:"a",code:"code",div:"div",h2:"h2",h3:"h3",hr:"hr",i:"i",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["In this lesson we're going to learn how to create a splash page that lists all of the objects saved in multiple database tables. A ",(0,a.jsx)(t.strong,{children:"splash page"})," is the first page that a user sees when they visit your site. They might contain promotions, offers, a beautiful image, or just be the homepage of your site."]}),"\n",(0,a.jsx)(t.p,{children:"In our To Do List app, our splash page won't be that special \u2014 it'll just be our homepage as it is with two new lists, one of all categories and the other of all items. Making this update will give us the opportunity to review concepts we've already covered and to practice displaying data from multiple database tables on one page."}),"\n",(0,a.jsx)(t.p,{children:"Let's get into it!"}),"\n",(0,a.jsxs)(t.h2,{id:"updating-the-homecontroller",children:["Updating the ",(0,a.jsx)(t.code,{children:"HomeController"})]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsxs)(t.p,{children:["We'll start with updating the ",(0,a.jsx)(t.code,{children:"HomeController"})," to connect to our database context."]}),"\n",(0,a.jsx)(t.p,{children:"Here's the first update we'll make:"}),"\n",(0,a.jsx)(t.div,{className:"filename",children:"Controllers/HomeController.cs"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:"using Microsoft.AspNetCore.Mvc;\nusing ToDoList.Models;\n\nnamespace ToDoList.Controllers\n{\n    public class HomeController : Controller\n    {\n      private readonly ToDoListContext _db;\n\n      public HomeController(ToDoListContext db)\n      {\n        _db = db;\n      }\n\n      ...\n\n    }\n}\n"})}),"\n",(0,a.jsxs)(t.p,{children:["We've added a new ",(0,a.jsx)(t.code,{children:"HomeController"})," class variable called ",(0,a.jsx)(t.code,{children:"_db"})," to hold our ",(0,a.jsx)(t.code,{children:"ToDoListContext"})," object, which is our connection to our MySQL database. Since the ",(0,a.jsx)(t.code,{children:"ToDoListContext"})," class is located within our ",(0,a.jsx)(t.code,{children:"ToDoList.Models"})," namespace, we also add a new using directive at the top of the file: ",(0,a.jsx)(t.code,{children:"using ToDoList.Models;"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Then we create a constructor for the ",(0,a.jsx)(t.code,{children:"HomeController"})," class with a ",(0,a.jsx)(t.code,{children:"db"})," parameter. The argument for the ",(0,a.jsx)(t.code,{children:"db"})," parameter will be passed to the ",(0,a.jsx)(t.code,{children:"HomeController"})," constructor via dependency injection when we run our app. This happens implicitly, which can feel like magic and make it harder to understand. The value of the argument for the ",(0,a.jsx)(t.code,{children:"db"})," parameter will be the ",(0,a.jsx)(t.code,{children:"ToDoListContext"})," database service that we set up in ",(0,a.jsx)(t.code,{children:"Program.cs"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Keep in mind that you are not expected to develop a deep understanding of dependency injection during the program. To optionally learn more about dependency injection, visit the MS Documentation article titled ",(0,a.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-6.0",children:"Dependency injection in ASP.NET Core"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Next, we'll update the ",(0,a.jsx)(t.code,{children:"Index()"})," action to gather all category and item objects from the database, and pass them into the view."]}),"\n",(0,a.jsx)(t.div,{className:"filename",children:"Controllers/HomeController.cs"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'using Microsoft.AspNetCore.Mvc;\nusing ToDoList.Models;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace ToDoList.Controllers\n{\n  public class HomeController : Controller\n  {\n    private readonly ToDoListContext _db;\n\n    public HomeController(ToDoListContext db)\n    {\n      _db = db;\n    }\n\n    [HttpGet("/")]\n    public ActionResult Index()\n    {\n      Category[] cats = _db.Categories.ToArray();\n      Item[] items = _db.Items.ToArray();\n      Dictionary<string,object[]> model = new Dictionary<string, object[]>();\n      model.Add("categories", cats);\n      model.Add("items", items);\n      return View(model);\n    }\n  }\n}\n'})}),"\n",(0,a.jsxs)(t.p,{children:["First take note that we add two new using directives at the top of our file: one for ",(0,a.jsx)(t.code,{children:"System.Collections.Generic;"})," to use the ",(0,a.jsx)(t.code,{children:"Dictionary<T,T>"})," class, and the other for ",(0,a.jsx)(t.code,{children:"System.Linq;"})," to use the ",(0,a.jsx)(t.code,{children:"ToArray()"})," method."]}),"\n",(0,a.jsxs)(t.p,{children:["Within the ",(0,a.jsx)(t.code,{children:"Index()"})," action we first access the categories table and turn it into an array of ",(0,a.jsx)(t.code,{children:"Category"})," objects. Then we access the items table and turn it into an array of ",(0,a.jsx)(t.code,{children:"Item"})," objects. We create an empty dictionary called ",(0,a.jsx)(t.code,{children:"model"})," and add each array to the dictionary. Finally, we pass the dictionary ",(0,a.jsx)(t.code,{children:"model"})," into the view with ",(0,a.jsx)(t.code,{children:"return View(model);"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Note that we could choose to create an entirely different data structure to pass the categories and items into the view. For example, we could use lists and ",(0,a.jsx)(t.code,{children:"ViewBag"})," like so:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'      [HttpGet("/")]\n      public ActionResult Index()\n      {\n        List<Category> cats = _db.Categories.ToList();\n        List<Item> items = _db.Items.ToList();\n        ViewBag.categories = cats;\n        ViewBag.items = items;\n        return View();\n      }\n'})}),"\n",(0,a.jsx)(t.p,{children:"But we'll stick with our first method of using arrays and dictionaries!"}),"\n",(0,a.jsxs)(t.p,{children:["Next, let's update the ",(0,a.jsx)(t.code,{children:"Home/Index.cshtml"})," view to display both categories and items."]}),"\n",(0,a.jsxs)(t.h2,{id:"updating-the-homeindexcshtml-view",children:["Updating the ",(0,a.jsx)(t.code,{children:"Home/Index.cshtml"})," View"]}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsxs)(t.p,{children:["Here's the updated code for the ",(0,a.jsx)(t.code,{children:"Home/Index.cshtml"})," view:"]}),"\n",(0,a.jsx)(t.div,{className:"filename",children:"Views/Home/Index.cshtml"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'@{\n  Layout = "_Layout";\n}\n\n@using ToDoList.Models;\n\n<h1>Welcome to the To Do List!</h1>\n\n<hr />\n\n<h4>Categories</h4>\n@if (Model["categories"].Length == 0)\n{\n  <p>No categories have been added yet!</p>\n} \n<ul>\n  @foreach (Category cat in Model["categories"])\n  {\n    <li>@Html.ActionLink(@cat.Name, "Details", "Categories", new { id = @cat.CategoryId})</li>\n  }\n</ul>\n\n<h4>Items</h4>\n@if (Model["items"].Length == 0)\n{\n  <p>No items have been added yet!</p>\n} \n<ul>\n  @foreach (Item item in Model["items"])\n  {\n    <li>@Html.ActionLink(@item.Description, "Details", "Items", new { id = @item.ItemId})</li>\n  }\n</ul>\n\n<hr />\n\n<p>@Html.ActionLink("Manage items", "Index", "Items")</p> \n<p>@Html.ActionLink("Manage categories", "Index", "Categories")</p>\n<p>@Html.ActionLink("Manage tags", "Index", "Tags")</p>\n'})}),"\n",(0,a.jsx)(t.p,{children:"Let's work through the changes:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["We include ",(0,a.jsx)(t.code,{children:"@using ToDoList.Models;"})," so we can reference the ",(0,a.jsx)(t.code,{children:"Item"})," and ",(0,a.jsx)(t.code,{children:"Category"})," types in our foreach loops."]}),"\n",(0,a.jsxs)(t.li,{children:["For both items and categories, we include a conditional that checks if there are any of those objects, and if not, informs the user of this. This is nothing new to us! Notice that arrays don't have a ",(0,a.jsx)(t.code,{children:"Count"})," property, but instead a ",(0,a.jsx)(t.code,{children:"Length"})," property that contains the number of elements within the array."]}),"\n",(0,a.jsx)(t.li,{children:"For both items and categories, we loop through each array and make an unordered list of the objects. Each object is a direct link to the details page for that object."}),"\n",(0,a.jsxs)(t.li,{children:["We've wrapped the list of categories and items with ",(0,a.jsx)(t.code,{children:"<hr />"})," tags to create a basic visual distinction on the page."]}),"\n",(0,a.jsxs)(t.li,{children:["Finally, the last update we make is updating the links at the bottom of the view to display ",(0,a.jsx)(t.code,{children:'"Manage..."'})," instead of ",(0,a.jsx)(t.code,{children:'"View all..."'}),". This change isn't strictly necessary, but I think it's a more descriptive name. As always, it's up to you to decide what makes the most sense."]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"And with that, we're done with this mini update to our homepage! Run your app and check out the new homepage."}),"\n",(0,a.jsx)(t.p,{children:"What do you think of the update we made? Do you like it or do you think it's unnecessary? Perhaps it's too boring for a splash page? There's no one right answer, however, we always encourage you to put yourself in the shoes of your user, and to make layout and navigation decisions that improve the user's experience."}),"\n",(0,a.jsx)(t.h3,{id:"repository-reference",children:"Repository Reference"}),"\n",(0,a.jsx)(t.p,{children:"Follow the link below to view how a sample version of the project should look at this point. Note that this is a link to a specific branch in the repository."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:(0,a.jsxs)(t.a,{href:"https://github.com/epicodus-lessons/section-4-to-do-list-with-many-to-many-csharp-net6/tree/6_data_from_multiple_db_tables",children:[(0,a.jsx)(t.i,{className:"glyphicon glyphicon-folder-open"}),"  GitHub Repo for To Do List with EF Core Migrations and a Many-to-Many Relationship: 6_data_from_multiple_db_tables"]})})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);