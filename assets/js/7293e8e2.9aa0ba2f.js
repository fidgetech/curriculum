"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[91358],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},35955:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"c-and-net/basic-web-applications/5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate","title":"\ud83d\udcd3 5.2.0.17 Redirecting to HTTPS and Issuing a Security Certificate","description":"In this lesson, we\'ll learn how to enable HTTPS redirection and set up security certificates for our web apps during development. While it\'s not always necessary to use HTTPS during development, it does provide additional security.","source":"@site/versioned_docs/version-WIP/c-and-net/2_basic-web-applications/3-2-0-17-redirecting-to-https-and-issuing-a-security-certificate.md","sourceDirName":"c-and-net/2_basic-web-applications","slug":"/c-and-net/basic-web-applications/5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate","draft":false,"unlisted":false,"tags":[],"version":"WIP","frontMatter":{"title":"\ud83d\udcd3 5.2.0.17 Redirecting to HTTPS and Issuing a Security Certificate","day":"weekend","id":"5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 5.2.0.16 Debugging Views and Configuring a Development Environment with launchSettings.json","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-16-debugging-views-and-configuring-a-development-environment-with-launchsettings-json"},"next":{"title":"\ud83d\udcd3 5.2.0.18 Configuration Quick Reference","permalink":"/WIP/c-and-net/basic-web-applications/5-2-0-18-configuration-quick-reference"}}');var s=n(74848),r=n(28453);const o={title:"\ud83d\udcd3 5.2.0.17 Redirecting to HTTPS and Issuing a Security Certificate",day:"weekend",id:"5-2-0-17-redirecting-to-https-and-issuing-a-security-certificate",hide_table_of_contents:!0},a=void 0,c={},d=[{value:"Enabling HTTPS Redirection",id:"enabling-https-redirection",level:2},{value:"Issuing and Trusting a Security Certificate",id:"issuing-and-trusting-a-security-certificate",level:2},{value:"Granting Keychain Access For Students Working on Macs",id:"granting-keychain-access-for-students-working-on-macs",level:3},{value:"Don&#39;t Have a Security Certificate?",id:"dont-have-a-security-certificate",level:3}];function l(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"In this lesson, we'll learn how to enable HTTPS redirection and set up security certificates for our web apps during development. While it's not always necessary to use HTTPS during development, it does provide additional security."}),"\n",(0,s.jsxs)(t.p,{children:["As we learned in previous lessons, ",(0,s.jsx)(t.strong,{children:"HTTP"}),' is a protocol to transfer documents (like HTML) between web browsers (also called "clients") and web servers (also called "servers"). All modern and widely-used browsers use HTTP. However, HTTP is not secure, which is why HTTPS was developed. The "S" in HTTPS stands for "secure" as ',(0,s.jsx)(t.strong,{children:"HTTPS"})," encrypts all communication between a client and a server."]}),"\n",(0,s.jsxs)(t.p,{children:["Web apps don't need to use HTTPS, though it is considered best practice to do so. In this lesson we'll learn how to enable HTTPS redirection and set up security certificates for our ASP.NET Core apps. Later in the course, we'll learn how to enable ",(0,s.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security",children:"HSTS"}),", which enforces that a website should only be accessed through HTTPS, and not merely redirected to from HTTP."]}),"\n",(0,s.jsx)(t.h2,{id:"enabling-https-redirection",children:"Enabling HTTPS Redirection"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.p,{children:"If you haven't noticed, ASP.NET Core offers two ports to access our web app, one for HTTP and the other for HTTPS:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["HTTP at ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"http://localhost:5000",children:"http://localhost:5000"})})]}),"\n",(0,s.jsxs)(t.li,{children:["HTTPS at ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"https://localhost:5001",children:"https://localhost:5001"})})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["So far, we've primarily accessed ",(0,s.jsx)(t.a,{href:"http://localhost:5000",children:"http://localhost:5000"}),", but we can access either. To increase security in our app, we can configure our host to redirect to HTTPS when our web app is accessed via HTTP. To do this, we need to update ",(0,s.jsx)(t.code,{children:"Program.cs"})," to add a middleware to our request pipeline. We'll add ",(0,s.jsx)(t.code,{children:"app.UseHttpsRedirection();"})," right below the creation of our ",(0,s.jsx)(t.code,{children:"WebApplication"})," host ",(0,s.jsx)(t.code,{children:"app"}),". Check out the code snippet below that shows the updated ",(0,s.jsx)(t.code,{children:"Program.cs"}),' from the "Friend Letter" project.']}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cs",children:'using Microsoft.AspNetCore.Builder;\nusing Microsoft.Extensions.DependencyInjection;\n\nnamespace FriendLetter\n{\n  class Program\n  {\n    static void Main(string[] args)\n    {\n      WebApplicationBuilder builder = WebApplication.CreateBuilder(args);\n\n      builder.Services.AddControllersWithViews();\n\n      WebApplication app = builder.Build();\n\n      // app.UseDeveloperExceptionPage();\n      app.UseHttpsRedirection();\n\n      app.UseRouting();\n\n      app.MapControllerRoute(\n        name: "default",\n        pattern: "{controller=Home}/{action=Index}/{id?}"\n      );\n\n      app.Run();\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Note that if we included the ",(0,s.jsx)(t.code,{children:"app.UseDeveloperExceptionPage();"})," middleware, we'd need to add ",(0,s.jsx)(t.code,{children:"app.UseHttpsRedirection();"})," right below it."]}),"\n",(0,s.jsxs)(t.p,{children:["Now with just one new line of code, if we access our application at ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"http://localhost:5000",children:"http://localhost:5000"})}),", we'll be redirected to ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"https://localhost:5001",children:"https://localhost:5001"})}),". Pretty neat! We recommend that you enable HTTPS redirection for all of your ASP.NET Core web apps going forward."]}),"\n",(0,s.jsx)(t.h2,{id:"issuing-and-trusting-a-security-certificate",children:"Issuing and Trusting a Security Certificate"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.p,{children:['For HTTPS to work, we need to have a security certificate set up for our web apps. The security certificate is a digital certificate that verifies the identity of a website and handles encrypting the data that\'s transferred between the website ("client") and the web server ("server"). These certificates are issued by certification authorities and follow specific protocols for encryption (see ',(0,s.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/SSL",children:"SSL"})," and ",(0,s.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Transport_Layer_Security",children:"TLS"})," for more information)."]}),"\n",(0,s.jsx)(t.p,{children:"Typically security certificates are set up during the process of hosting a web app. However, when using HTTPS in development, we need to set one up via .NET. Fortunately, this is very easy to do via the command line."}),"\n",(0,s.jsxs)(t.p,{children:["First let's learn how to recognize when there are issues with the security certificate. If we ever navigate to ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"https://localhost:5001/",children:"https://localhost:5001/"})})," and we get the following message in the browser, that means that there's something wrong with our security certificate:"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Message in the web browser that indicates the connection is not safe.",src:n(56065).A+"",width:"695",height:"397"})}),"\n",(0,s.jsx)(t.p,{children:"The good thing to note is that it's very easy to fix this issue. Simply open your terminal and enter the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ dotnet dev-certs https --trust\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Note that if you are taking classes in person at Epicodus, you do not need to run this command on the campus mac computers."})}),"\n",(0,s.jsx)(t.p,{children:"When we enter this command, we should see a pop-up box with a message asking yet whether we want to proceed. Select the button that corresponds to 'yes', and then you'll have a trusted certificate for HTTPS during development."}),"\n",(0,s.jsxs)(t.p,{children:["The next step is to restart your web browser to clear its cache, then navigate to ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.a,{href:"https://localhost:5001/",children:"https://localhost:5001/"})})," to confirm that you can access the site without error."]}),"\n",(0,s.jsx)(t.p,{children:"Note that with the original download of the .NET 6 SDK, we also downloaded a security certificate. So the process outlined above doesn't create a new one, but trusts the already existing certificate."}),"\n",(0,s.jsx)(t.p,{children:"And with that, we're ready to go! You should only have to do this once for your computer, or after a major update like upgrading to a new version of .NET."}),"\n",(0,s.jsx)(t.h3,{id:"granting-keychain-access-for-students-working-on-macs",children:"Granting Keychain Access For Students Working on Macs"}),"\n",(0,s.jsxs)(t.p,{children:["With ",(0,s.jsx)(t.code,{children:"app.UseHttpsRedirection();"})," enabled, students who are working on macs in person or remotely may be asked to be granted keychain access to get the details of the dev cert for each new application they create. The request will pop up after you run your web app with ",(0,s.jsx)(t.code,{children:"dotnet watch run"}),", and it will look similar to the following image with some details being different."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Pop-up box with request to access keychain to get the details of the dev cert on a mac.",src:n(90546).A+"",width:"902",height:"430"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:'If you see this request after running your app, enter in your password and select "always allow".'}),' For  mac computers on campus at Epicodus, the password is "epicodus".']}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"If for some reason you cannot grant access to your keychain and this is preventing you from running your application in the browser"}),", you can always use HTTP instead of HTTPS. Simply remove the line ",(0,s.jsx)(t.code,{children:"app.UseHttpsRedirection();"})," from ",(0,s.jsx)(t.code,{children:"Program.cs"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"dont-have-a-security-certificate",children:"Don't Have a Security Certificate?"}),"\n",(0,s.jsx)(t.p,{children:"Not having a certificate at all is extremely unlikely. You'll know you don't have a security certificate, because you won't be able to access localhost via HTTPS at all. In this case, to generate a security certificate, run the following command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ dotnet dev-certs https\n"})}),"\n",(0,s.jsx)(t.p,{children:"And then trust the certificate with this command:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ dotnet dev-certs https --trust\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You can also clear all existing certificates and check whether you have one issued to begin with. To see all possible commands and tools for ",(0,s.jsx)(t.code,{children:"dev-certs"}),", enter the following command into your command line:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ dotnet dev-certs https --help\n"})}),"\n",(0,s.jsxs)(t.p,{children:["To learn more about the ",(0,s.jsx)(t.code,{children:"dev-certs"})," tool, visit ",(0,s.jsxs)(t.a,{href:"https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-dev-certs",children:["the Microsoft documentation on ",(0,s.jsx)(t.code,{children:"dev-certs"})]}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["To learn more about trusting the ASP.NET Core development security certificate, visit ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/aspnet/core/security/enforcing-ssl?view=aspnetcore-6.0&tabs=visual-studio-code#trust-the-aspnet-core-https-development-certificate-on-windows-and-macos",children:"this Microsoft documentation"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},56065:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/security-cert-connection-not-private-d7b3c7302ed41f31f13a340c198b57db.png"},90546:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/dotnet-dev-cert-password-request-75b690556dc70c8585a0ae600c2f4938.png"}}]);