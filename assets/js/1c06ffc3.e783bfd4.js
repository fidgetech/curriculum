"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[65411],{28453:(e,n,a)=>{a.d(n,{R:()=>s,x:()=>o});var t=a(96540);const d={},i=t.createContext(d);function s(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),t.createElement(i.Provider,{value:n},e.children)}},86692:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>r});const t=JSON.parse('{"id":"c-and-net/building-an-api/3-6-0-07-seeding-the-database","title":"\ud83d\udcd3 3.6.0.07 Seeding the Database","description":"In the last lesson, we added update and delete functionality to our Cretaceous Park API. In this lesson, we\'ll learn how to seed the database with data upon initialization.","source":"@site/versioned_docs/version-v1_3/3_c-and-net/6_building-an-api/3-6-0-07-seeding-the-database.md","sourceDirName":"3_c-and-net/6_building-an-api","slug":"/c-and-net/building-an-api/3-6-0-07-seeding-the-database","permalink":"/v1.3/c-and-net/building-an-api/3-6-0-07-seeding-the-database","draft":false,"unlisted":false,"tags":[],"version":"v1_3","frontMatter":{"title":"\ud83d\udcd3 3.6.0.07 Seeding the Database","day":"weekend","id":"3-6-0-07-seeding-the-database","hide_table_of_contents":true},"sidebar":"c-and-net","previous":{"title":"\ud83d\udcd3 3.6.0.04 Adding a Model and Database","permalink":"/v1.3/c-and-net/building-an-api/3-6-0-04-adding-a-model-and-database"},"next":{"title":"\ud83d\udcd3 3.6.0.05 API: Create and Read","permalink":"/v1.3/c-and-net/building-an-api/3-6-0-05-api-create-and-read"}}');var d=a(74848),i=a(28453);const s={title:"\ud83d\udcd3 3.6.0.07 Seeding the Database",day:"weekend",id:"3-6-0-07-seeding-the-database",hide_table_of_contents:!0},o=void 0,l={},r=[{value:"Seeding Data",id:"seeding-data",level:3}];function c(e){const n={a:"a",code:"code",div:"div",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.p,{children:"In the last lesson, we added update and delete functionality to our Cretaceous Park API. In this lesson, we'll learn how to seed the database with data upon initialization."}),"\n",(0,d.jsx)(n.h3,{id:"seeding-data",children:"Seeding Data"}),"\n",(0,d.jsxs)(n.p,{children:["In order for us to more quickly and efficiently test our API without having to manually add data in MySQLWorkbench or via POST requests, we will automate the process of ",(0,d.jsx)(n.strong,{children:"seeding"})," the database. Seeding a database is simply populating a database with data. The data can range from important and necessary authorization user roles to just dummy data."]}),"\n",(0,d.jsxs)(n.p,{children:["In the case of the Cretaceous Park API, we'll seed the database with a handful of ",(0,d.jsx)(n.code,{children:"Animal"})," entries so that we can test our code to make sure we can properly filter ",(0,d.jsx)(n.code,{children:"Animal"}),"s by search parameters."]}),"\n",(0,d.jsxs)(n.p,{children:["In order to add the data, let's override the ",(0,d.jsx)(n.code,{children:"OnModelCreating"})," method that belongs to Entity Framework's ",(0,d.jsx)(n.code,{children:"DbContext"})," class by adding the following to our ",(0,d.jsx)(n.code,{children:"CretaceousApiContext"})," class:"]}),"\n",(0,d.jsx)(n.div,{className:"filename",children:"Models/CretaceousApiContext.cs"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-csharp",children:'...\nprotected override void OnModelCreating(ModelBuilder builder)\n{\n  builder.Entity<Animal>()\n    .HasData(\n      new Animal { AnimalId = 1, Name = "Matilda", Species = "Woolly Mammoth", Age = 7, Gender = "Female" },\n      new Animal { AnimalId = 2, Name = "Rexie", Species = "Dinosaur", Age = 10, Gender = "Female" },\n      new Animal { AnimalId = 3, Name = "Matilda", Species = "Dinosaur", Age = 2, Gender = "Female" },\n      new Animal { AnimalId = 4, Name = "Pip", Species = "Shark", Age = 4, Gender = "Male" },\n      new Animal { AnimalId = 5, Name = "Bartholomew", Species = "Dinosaur", Age = 22, Gender = "Male" }\n  );\n}\n...\n'})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["We declare the method as ",(0,d.jsx)(n.code,{children:"protected override"})," since we only want this method to be accessible to the class itself and we want to override the default method. Since the method doesn't return anything, we also specify ",(0,d.jsx)(n.code,{children:"void"})," as the return value."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["The method accepts an argument of type ",(0,d.jsx)(n.code,{children:"ModelBuilder"})," that we will call ",(0,d.jsx)(n.code,{children:"builder"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["We then call the ",(0,d.jsx)(n.code,{children:"builder"}),"'s ",(0,d.jsx)(n.code,{children:"Entity<Type>()"})," method which returns an ",(0,d.jsx)(n.code,{children:"EntityTypeBuilder"})," object that allows us to configure the type we specify in the method call."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["We can then call the ",(0,d.jsx)(n.code,{children:"HasData()"})," method of the returned ",(0,d.jsx)(n.code,{children:"EntityTypeBuilder"})," and pass the method any manner of entries we'd like to use to seed the database. We'll add five initial ",(0,d.jsx)(n.code,{children:"Animal"})," entries to our database."]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"We can now create a new migration and update the database:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"$ dotnet ef migrations add SeedData\n$ dotnet ef database update\n"})}),"\n",(0,d.jsxs)(n.p,{children:["We should be able to see our 5 new ",(0,d.jsx)(n.code,{children:"Animal"})," entries in the database. If you'd like to read more about Data Seeding, take a peek at the ",(0,d.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/ef/core/modeling/data-seeding",children:"official documentation"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}}}]);